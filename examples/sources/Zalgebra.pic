# Zalgebra.pic
# Complex arithmetic
rtod = 360/(atan2(1,1)*8)
dtor = atan2(1,1)*8/360
pi = 3.141592726

#                           Operations on pairs
define zsum {$1+($3),$2+($4)}
define zdiff {$1-($3),$2-($4)}
define zprod {(($1)*($3)-($2)*($4)),(($1)*($4)+($2)*($3))}
define zdiv {(($1)*($3)+($2)*($4))/(($3)^2+($4)^2),\
(($2)*($3)-($1)*($4))/(($3)^2+($4)^2)}
define zabs { sqrt(($1)^2+($2)^2) }
define argd { atan2($2,$1)*rtod }
define ztodB { 20*log(zabs($1,$2)),argd($1,$2) }

#                           Operations on pic locations
define Zsum {(($1).x+($2).x),(($1).y+($2).y)}
define Zdiff {(($1).x-($2).x),(($1).y-($2).y)}
define Zprod {(($1).x*($2).x-($1).y*($2).y),(($1).x*($2).y+($1).y*($2).x)}
define Zdiv {((($1).x*($2).x+($1).y*($2).y),(($1).y*($2).x-($1).x*($2).y))\
/(($2).x^2+($2).y^2)}
define Zabs { sqrt(($1).x^2+($1).y^2) }
define Argd { atan2(($1).y,($1).x)*rtod }
define ZtoB { 20*log(Zabs($1)),Argd($1) }  # dB gain, phase deg
define BtoZ { exp(($1).x/20)*cosd(($1).y),exp(($1).x/20)*sind(($1).y) }

define Zalgebra {1}
